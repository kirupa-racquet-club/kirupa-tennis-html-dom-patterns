<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>HTML DOM Patterns</title>
	<style type="text/css">
	.pattern {
		border: 10px solid black;
		overflow: hidden;
		position: relative;
	}
	.pattern * {
		position: absolute;
	}

	.patch {
		width: 100px;
		height: 100px;
		background-color: SteelBlue;
		overflow: hidden;
	}

	.patch .pixel {
		width: 3px;
		height: 3px;
		background-color: DeepSkyBlue;
	}
	</style>
</head>
<body>

<script>
function createPatch(str){
	var textSize = 10;
	var w = textSize * str.length; // Text is taller than it is wide, so this won't actually give a valid result, it will just make the canvas wider than it needs to be. In order to not waste "canvas pixels" (because they are a rare commodity) we need to find a way to accurately measure the resulting with from whatever the HTML5 equivalent of a TextField is. If you can read this, you either have line wrapping on; if not "Haha! Made you scroll!" http://cdn-static.zdnet.com/i/story/60/05/003301/nelson-muntz.gif
	var h = textSize + 3; // some sort of buffer for stuff under the baseline
	var patch = document.createElement("div");
	patch.className = "patch";
	
    var canvas = document.createElement("canvas");
    canvas.width = w;
    canvas.height = h;
	
    var ctx = canvas.getContext("2d");
    ctx.fillStyle = "black";
    ctx.font = textSize + "px monospace"; // "px Consolas"
    ctx.fillText(str, 0, textSize, w);
	
	var pixels = ctx.getImageData(0, 0, w, h).data;
	var pixelSize = 3;

	for(var i = 0; i < pixels.length; i += 4 /* bytes */){
		var pixelAlpha = pixels[i + 3];
		if(!pixelAlpha) continue;
		var pixelID = Math.floor(i / 4);
		var x = Math.floor(pixelID % w) * pixelSize;
		var y = Math.floor(pixelID / w) * pixelSize;
		patch.appendChild(createElemAt(x, y, "pixel"));
	}
	
	return patch;
}

function createElemAt(x, y, className){
	var elem = document.createElement("div");
	elem.className = className;
	elem.style.left = x + "px";
	elem.style.top = y + "px";
	return elem;
}

function createPattern(countX, countY, offsetX, offsetY, srcPatch){
	var pattern = document.createElement("div");
	pattern.className = "pattern";
	pattern.style.width = countX * offsetX + "px";
	pattern.style.height = countY * offsetY + "px";

	for (var y=0; y<countY; y++){
		for (var x=0; x<countX; x++){
			
			var patch = srcPatch.cloneNode(true);
			patch.style.left = x * offsetX + "px";
			patch.style.top = y * offsetY + "px";
			pattern.appendChild(patch);

		}
	}
	
	return pattern;
}

var patch = createPatch("O___o");
var pattern = createPattern(6, 4, 100, 100, patch);
document.body.appendChild(pattern);
</script>
</body>
</html>
